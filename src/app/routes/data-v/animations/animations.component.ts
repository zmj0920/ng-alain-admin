import { Component, EventEmitter, Input, OnInit, Output, TemplateRef, ViewChild } from '@angular/core';
import { WithConfig } from 'ng-zorro-antd/core/config';
import { NzSafeAny, OnChangeType, OnTouchedType } from 'ng-zorro-antd/core/types';
import { InputBoolean } from 'ng-zorro-antd/core/util';
import {
  NzFilterOptionType,
  NzSelectComponent,
  NzSelectItemInterface,
  NzSelectModeType,
  NzSelectOptionInterface,
  NzSelectSizeType
} from 'ng-zorro-antd/select';
import { from, Subject } from 'rxjs';
import { fadeInUp, flyIn } from 'src/app/shared/animations/fadeInUp';

const defaultFilterOption: NzFilterOptionType = (searchValue: string, item: NzSelectItemInterface): boolean => {
  if (item && item.nzLabel) {
    return item.nzLabel.toString().toLowerCase().indexOf(searchValue.toLowerCase()) > -1;
  } else {
    return false;
  }
};

@Component({
  selector: 'app-animations',
  templateUrl: './animations.component.html',
  styleUrls: ['./animations.component.less'],
  animations: [flyIn, fadeInUp]
})
export class AnimationsComponent implements OnInit {
  msg = new Subject<any>();
  option = [
    { value: '1', label: '1' },
    { value: '2', label: '2' },
    { value: '3', label: '3' },
    { value: '4', label: '4' },
    { value: '5', label: '5' },
    { value: '6', label: '6' },
    { value: '7', label: '7' },
    { value: '8', label: '8' },
    { value: '9', label: '9' }
  ];
  fontSizePx = 16;
  constructor() {}

  menuData = [
    {
      createdAt: '2020-08-28 10:09:26',
      updatedAt: '2021-12-08 14:51:06',
      id: 1,
      parentId: null,
      name: '系统',
      router: '/sys',
      perms: null,
      type: 0,
      icon: 'icon-shezhi',
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-08-01 00:00:00',
      updatedAt: '2021-12-08 14:52:50',
      id: 3,
      parentId: 1,
      name: '权限管理',
      router: '/sys/permssion',
      perms: null,
      type: 0,
      icon: 'icon-quanxian',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-08-08 00:00:00',
      updatedAt: '2021-12-08 14:53:35',
      id: 4,
      parentId: 3,
      name: '用户列表',
      router: '/sys/permssion/user',
      perms: null,
      type: 1,
      icon: 'icon-yonghu',
      orderNum: 0,
      viewPath: 'views/system/permission/user',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-08-15 00:00:00',
      updatedAt: '2020-09-11 06:11:52',
      id: 5,
      parentId: 4,
      name: '新增',
      router: null,
      perms: 'sys:user:add',
      type: 2,
      icon: null,
      orderNum: 0,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-08-15 00:00:00',
      updatedAt: '2020-09-11 06:13:03',
      id: 6,
      parentId: 4,
      name: '删除',
      router: null,
      perms: 'sys:user:delete',
      type: 2,
      icon: null,
      orderNum: 0,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-08-08 00:00:00',
      updatedAt: '2021-12-08 15:05:56',
      id: 7,
      parentId: 3,
      name: '菜单列表',
      router: '/sys/permssion/menu',
      perms: null,
      type: 1,
      icon: 'icon-tiaoxingtu',
      orderNum: 0,
      viewPath: 'views/system/permission/menu',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-08-15 00:00:00',
      updatedAt: '2020-08-15 00:00:00',
      id: 8,
      parentId: 7,
      name: '新增',
      router: null,
      perms: 'sys:menu:add',
      type: 2,
      icon: null,
      orderNum: 0,
      viewPath: null,
      keepalive: true,
      isShow: false
    },
    {
      createdAt: '2020-08-15 00:00:00',
      updatedAt: '2020-08-15 00:00:00',
      id: 9,
      parentId: 7,
      name: '删除',
      router: null,
      perms: 'sys:menu:delete',
      type: 2,
      icon: null,
      orderNum: 0,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-02 08:22:27',
      updatedAt: '2020-09-02 08:22:27',
      id: 10,
      parentId: 7,
      name: '查询',
      router: null,
      perms: 'sys:menu:list,sys:menu:info',
      type: 2,
      icon: null,
      orderNum: 0,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-04 06:26:36',
      updatedAt: '2020-09-04 07:13:30',
      id: 17,
      parentId: 16,
      name: '测试',
      router: '',
      perms: 'sys:menu:list,sys:menu:update,sys:menu:info,sys:menu:add',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-04 08:08:53',
      updatedAt: '2020-09-04 08:08:53',
      id: 19,
      parentId: 7,
      name: '修改',
      router: '',
      perms: 'sys:menu:update',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-04-12 04:28:03',
      updatedAt: '2021-04-20 10:18:22',
      id: 20,
      parentId: 4,
      name: '部门移动排序',
      router: null,
      perms: 'sys:dept:move',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-04 09:41:43',
      updatedAt: '2021-12-08 15:05:56',
      id: 23,
      parentId: 3,
      name: '角色列表',
      router: '/sys/permission/role',
      perms: '',
      type: 1,
      icon: 'icon-jiaosequanxian',
      orderNum: 0,
      viewPath: 'views/system/permission/role',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-07 02:44:27',
      updatedAt: '2020-09-07 08:51:18',
      id: 25,
      parentId: 23,
      name: '删除',
      router: '',
      perms: 'sys:role:delete',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-07 02:49:36',
      updatedAt: '2021-12-10 14:31:40',
      id: 26,
      parentId: 44,
      name: 'antdv文档',
      router: 'https://next.antdv.com/components/overview-cn/',
      perms: '',
      type: 1,
      icon: 'icon-ant-design',
      orderNum: 0,
      viewPath: 'views/charts/keyboard',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-07 02:50:03',
      updatedAt: '2021-12-10 14:31:40',
      id: 27,
      parentId: 44,
      name: 'TypeORM中文文档',
      router: 'https://www.bookstack.cn/read/TypeORM-0.2.20-zh/README.md',
      perms: '',
      type: 1,
      icon: 'icon-duqushujuku',
      orderNum: 2,
      viewPath: 'views/error-log/components/ErrorTestB',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-07 07:08:18',
      updatedAt: '2020-09-14 10:26:58',
      id: 28,
      parentId: 23,
      name: '新增',
      router: '',
      perms: 'sys:role:add',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-07 08:51:48',
      updatedAt: '2020-09-07 08:51:58',
      id: 29,
      parentId: 23,
      name: '修改',
      router: '',
      perms: 'sys:role:update',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-07 10:39:50',
      updatedAt: '2020-09-09 06:34:13',
      id: 32,
      parentId: 23,
      name: '查询',
      router: '',
      perms: 'sys:role:list,sys:role:page,sys:role:info',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-08 05:29:40',
      updatedAt: '2020-09-11 06:03:43',
      id: 33,
      parentId: 4,
      name: '部门查询',
      router: '',
      perms: 'sys:dept:list,sys:dept:info',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-09 07:10:08',
      updatedAt: '2020-09-10 03:41:32',
      id: 34,
      parentId: 4,
      name: '查询',
      router: '',
      perms: 'sys:user:page,sys:user:info',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-10 05:09:31',
      updatedAt: '2020-09-10 05:09:31',
      id: 35,
      parentId: 4,
      name: '更新',
      router: '',
      perms: 'sys:user:update',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-10 08:02:29',
      updatedAt: '2020-09-10 08:02:40',
      id: 36,
      parentId: 4,
      name: '部门转移',
      router: '',
      perms: 'sys:dept:transfer',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-11 04:34:00',
      updatedAt: '2021-12-08 15:07:26',
      id: 37,
      parentId: 1,
      name: '系统监控',
      router: '/sys/monitor',
      perms: '',
      type: 0,
      icon: 'icon-jiankong1',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-11 06:12:14',
      updatedAt: '2020-09-11 06:12:14',
      id: 39,
      parentId: 4,
      name: '部门新增',
      router: '',
      perms: 'sys:dept:add',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-11 06:13:23',
      updatedAt: '2020-09-11 06:13:23',
      id: 40,
      parentId: 4,
      name: '部门删除',
      router: '',
      perms: 'sys:dept:delete',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-11 06:29:52',
      updatedAt: '2020-09-11 06:29:52',
      id: 41,
      parentId: 4,
      name: '部门更新',
      router: '',
      perms: 'sys:dept:update',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-09-14 03:56:24',
      updatedAt: '2021-12-10 14:31:40',
      id: 44,
      parentId: null,
      name: '文档',
      router: '/document',
      perms: '',
      type: 0,
      icon: 'icon-icon_shiyongwendang',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-12 10:00:49',
      updatedAt: '2021-12-08 15:07:26',
      id: 51,
      parentId: 37,
      name: '在线用户',
      router: '/sys/monitor/online',
      perms: null,
      type: 1,
      icon: 'icon-zaixianyonghujiankong',
      orderNum: 0,
      viewPath: 'views/system/monitor/online',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-13 03:01:13',
      updatedAt: '2020-10-13 03:01:13',
      id: 52,
      parentId: 51,
      name: '查询',
      router: '',
      perms: 'sys:online:list',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-13 03:01:51',
      updatedAt: '2020-10-13 03:01:51',
      id: 53,
      parentId: 51,
      name: '下线',
      router: '',
      perms: 'sys:online:kick',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-13 09:52:08',
      updatedAt: '2021-12-08 15:13:05',
      id: 55,
      parentId: 37,
      name: '登录日志',
      router: '/sys/monitor/login-log',
      perms: null,
      type: 1,
      icon: 'icon-guide',
      orderNum: 0,
      viewPath: 'views/system/monitor/login-log',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-13 09:56:13',
      updatedAt: '2020-10-13 09:56:13',
      id: 56,
      parentId: 55,
      name: '查询',
      router: '',
      perms: 'sys:log:login:page',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-19 03:07:18',
      updatedAt: '2021-12-08 15:13:46',
      id: 57,
      parentId: 1,
      name: '任务调度',
      router: '/sys/schedule',
      perms: null,
      type: 0,
      icon: 'icon-rizhi1',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-19 03:08:15',
      updatedAt: '2021-12-08 15:13:05',
      id: 58,
      parentId: 57,
      name: '定时任务',
      router: '/sys/schedule/task',
      perms: null,
      type: 1,
      icon: 'icon-dingshirenwuguanli',
      orderNum: 0,
      viewPath: 'views/system/schedule/task',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-19 03:08:36',
      updatedAt: '2020-10-19 03:08:36',
      id: 59,
      parentId: 58,
      name: '查询',
      router: '',
      perms: 'sys:task:page,sys:task:info',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-19 03:09:09',
      updatedAt: '2020-10-19 03:09:09',
      id: 60,
      parentId: 58,
      name: '新增',
      router: '',
      perms: 'sys:task:add',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-19 03:09:42',
      updatedAt: '2020-10-19 03:09:42',
      id: 61,
      parentId: 58,
      name: '更新',
      router: '',
      perms: 'sys:task:update',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-19 05:45:30',
      updatedAt: '2020-10-19 05:45:30',
      id: 62,
      parentId: 58,
      name: '执行一次',
      router: '',
      perms: 'sys:task:once',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-19 05:46:01',
      updatedAt: '2020-10-19 05:46:01',
      id: 63,
      parentId: 58,
      name: '运行',
      router: '',
      perms: 'sys:task:start',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-19 05:46:23',
      updatedAt: '2020-10-19 05:46:23',
      id: 64,
      parentId: 58,
      name: '暂停',
      router: '',
      perms: 'sys:task:stop',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-19 06:25:52',
      updatedAt: '2020-10-19 06:25:52',
      id: 65,
      parentId: 58,
      name: '删除',
      router: '',
      perms: 'sys:task:delete',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-19 07:30:18',
      updatedAt: '2021-12-08 15:16:03',
      id: 66,
      parentId: 57,
      name: '任务日志',
      router: '/sys/schedule/log',
      perms: null,
      type: 1,
      icon: 'icon-rizhi1',
      orderNum: 0,
      viewPath: 'views/system/schedule/log',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2020-10-19 08:09:49',
      updatedAt: '2020-10-19 08:09:49',
      id: 67,
      parentId: 66,
      name: '查询',
      router: '',
      perms: 'sys:log:task:page',
      type: 2,
      icon: '',
      orderNum: 0,
      viewPath: '',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-04-21 08:54:41',
      updatedAt: '2021-04-21 08:54:41',
      id: 68,
      parentId: 4,
      name: '更改密码',
      router: null,
      perms: 'sys:user:password',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2022-03-11 01:20:42',
      updatedAt: '2022-03-11 01:26:46',
      id: 69,
      parentId: 37,
      name: '服务监控',
      router: '/sys/monitor/serve',
      perms: null,
      type: 1,
      icon: 'zaixianyonghujiankong',
      orderNum: 255,
      viewPath: 'views/system/monitor/serve',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2022-03-11 01:22:47',
      updatedAt: '2022-03-11 01:26:46',
      id: 70,
      parentId: 37,
      name: '请求日志',
      router: '/sys/schedule/req-log',
      perms: null,
      type: 1,
      icon: 'zhexiantu',
      orderNum: 255,
      viewPath: 'views/system/monitor/req-log',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-05-16 01:38:40',
      updatedAt: '2022-09-18 03:07:56',
      id: 72,
      parentId: null,
      name: '网盘空间',
      router: '/netdisk',
      perms: null,
      type: 0,
      icon: 'icon-wangpankongjian',
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-05-16 01:39:06',
      updatedAt: '2022-09-18 03:07:56',
      id: 73,
      parentId: 72,
      name: '空间管理',
      router: '/netdisk/manage',
      perms: null,
      type: 1,
      icon: 'icon-wangpan',
      orderNum: 255,
      viewPath: 'views/netdisk/manage',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-05-16 01:40:03',
      updatedAt: '2021-05-16 01:40:03',
      id: 74,
      parentId: 73,
      name: '查询',
      router: null,
      perms: 'netdisk:manage:list',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-05-16 01:40:27',
      updatedAt: '2021-05-16 01:40:27',
      id: 75,
      parentId: 73,
      name: '创建文件夹',
      router: null,
      perms: 'netdisk:manage:mkdir',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-05-16 01:40:42',
      updatedAt: '2021-05-16 01:40:42',
      id: 76,
      parentId: 73,
      name: '上传',
      router: null,
      perms: 'netdisk:manage:token',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-05-16 01:40:57',
      updatedAt: '2021-05-16 01:41:36',
      id: 77,
      parentId: 73,
      name: '重命名',
      router: null,
      perms: 'netdisk:manage:rename,netdisk:manage:check',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-05-16 01:41:15',
      updatedAt: '2021-05-16 01:41:15',
      id: 78,
      parentId: 73,
      name: '下载',
      router: null,
      perms: 'netdisk:manage:download',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-05-16 01:41:56',
      updatedAt: '2021-05-16 01:41:56',
      id: 79,
      parentId: 73,
      name: '删除',
      router: null,
      perms: 'netdisk:manage:delete,netdisk:manage:check',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-05-16 01:42:17',
      updatedAt: '2021-05-16 01:42:17',
      id: 80,
      parentId: 73,
      name: '预览',
      router: null,
      perms: 'netdisk:manage:info',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-05-16 23:42:36',
      updatedAt: '2021-05-16 23:42:36',
      id: 81,
      parentId: 73,
      name: '备注',
      router: null,
      perms: 'netdisk:manage:mark',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-05-20 21:53:56',
      updatedAt: '2021-05-20 21:53:56',
      id: 82,
      parentId: 73,
      name: '复制',
      router: null,
      perms: 'netdisk:manage:check,netdisk:manage:copy',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-05-20 21:54:18',
      updatedAt: '2021-05-20 21:54:18',
      id: 83,
      parentId: 73,
      name: '剪切',
      router: null,
      perms: 'netdisk:manage:check,netdisk:manage:cut',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-05-27 15:30:32',
      updatedAt: '2022-09-20 16:44:42',
      id: 84,
      parentId: 72,
      name: '网盘概览',
      router: '/netdisk/overview',
      perms: null,
      type: 1,
      icon: 'icon-gailan',
      orderNum: 255,
      viewPath: 'views/netdisk/overview',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-09-28 03:22:42',
      updatedAt: '2022-09-18 03:53:14',
      id: 85,
      parentId: 1,
      name: '参数配置',
      router: '/sys/param-config',
      perms: null,
      type: 0,
      icon: 'xitongcanshupeizhi',
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-09-28 03:25:47',
      updatedAt: '2022-09-18 03:50:43',
      id: 86,
      parentId: 85,
      name: '参数列表',
      router: '/sys/param-config/list',
      perms: null,
      type: 1,
      icon: 'kehucanshupeizhi',
      orderNum: 255,
      viewPath: 'views/system/param-config/config-list',
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-09-28 03:26:27',
      updatedAt: '2021-09-28 07:55:44',
      id: 87,
      parentId: 86,
      name: 'æŸ¥è¯¢',
      router: null,
      perms: 'sys:param-config:page,sys:param-config:info',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-09-28 07:56:03',
      updatedAt: '2021-09-28 07:56:03',
      id: 88,
      parentId: 86,
      name: 'æ–°å¢ž',
      router: null,
      perms: 'sys:param-config:add',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-09-28 07:56:26',
      updatedAt: '2021-09-28 07:56:26',
      id: 89,
      parentId: 86,
      name: 'åˆ é™¤',
      router: null,
      perms: 'sys:param-config:delete',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2021-09-28 07:56:47',
      updatedAt: '2021-09-28 07:56:47',
      id: 90,
      parentId: 86,
      name: 'æ›´æ–°',
      router: null,
      perms: 'sys:param-config:update',
      type: 2,
      icon: null,
      orderNum: 255,
      viewPath: null,
      keepalive: true,
      isShow: true
    },
    {
      createdAt: '2022-09-29 15:43:28',
      updatedAt: '2022-09-29 15:43:28',
      id: 101,
      parentId: null,
      name: '学习',
      router: './xuexi',
      perms: null,
      type: 0,
      icon: 'wangpan',
      orderNum: 1,
      viewPath: null,
      keepalive: true,
      isShow: true
    }
  ];

  menus = [
    { createdAt: '2022-09-28 20:52:48', updatedAt: '2022-09-28 20:52:48', id: 505, roleId: 3, menuId: 73 },
    { createdAt: '2022-09-28 20:52:48', updatedAt: '2022-09-28 20:52:48', id: 506, roleId: 3, menuId: 72 },
    { createdAt: '2022-09-28 20:52:48', updatedAt: '2022-09-28 20:52:48', id: 507, roleId: 3, menuId: 74 },
    { createdAt: '2022-09-29 16:27:17', updatedAt: '2022-09-29 16:27:17', id: 570, roleId: 3, menuId: 75 },
    { createdAt: '2022-09-29 16:27:17', updatedAt: '2022-09-29 16:27:17', id: 571, roleId: 3, menuId: 76 },
    { createdAt: '2022-09-29 16:27:17', updatedAt: '2022-09-29 16:27:17', id: 572, roleId: 3, menuId: 77 },
    { createdAt: '2022-09-29 16:27:17', updatedAt: '2022-09-29 16:27:17', id: 573, roleId: 3, menuId: 78 },
    { createdAt: '2022-09-29 16:27:17', updatedAt: '2022-09-29 16:27:17', id: 574, roleId: 3, menuId: 79 },
    { createdAt: '2022-09-29 16:27:17', updatedAt: '2022-09-29 16:27:17', id: 575, roleId: 3, menuId: 80 },
    { createdAt: '2022-09-29 16:27:17', updatedAt: '2022-09-29 16:27:17', id: 576, roleId: 3, menuId: 81 },
    { createdAt: '2022-09-29 16:27:17', updatedAt: '2022-09-29 16:27:17', id: 577, roleId: 3, menuId: 82 },
    { createdAt: '2022-09-29 16:27:17', updatedAt: '2022-09-29 16:27:17', id: 578, roleId: 3, menuId: 83 }
  ];

  ngOnInit(): void {
    const menuIds = this.menus.map(n => n.menuId);
    const menuTree = this.formatMenu2Tree(this.menuData);

    const tree = this.getCheckedKeys(menuIds, menuTree);

    console.log(tree);
    console.log(menuTree);

    // this.test();
  }

  test() {
    this.msg.subscribe(console.log);
    from([1, 2, 3]).subscribe(this.msg);
  }

  formatMenu2Tree(menus: any, parentId: number | null = null, keyPath: (string | number)[] = []): any[] {
    return menus
      .filter((item: any) => item.parentId === parentId)
      .filter((item: any) => item.parentId === parentId)
      .map((item: any) => {
        const _keyPath = keyPath.concat(parentId || []);
        const arr = this.formatMenu2Tree(menus, item.id, _keyPath);
        return Object.assign(item, {
          keyPath: _keyPath,
          title: item.name,
          key: item.id,
          value: item.id,
          formData: item,
          children: arr.length ? arr : null
        });
      });
  }

  getCheckedKeys(checkedList: number[], options: any[], total = []) {
    return options.reduce<number[]>((prev, curr) => {
      if (curr.children?.length) {
        this.getCheckedKeys(checkedList, curr.children, total);
      } else {
        if (checkedList.includes(curr.value)) {
          prev.push(curr.value);
        }
      }
      return prev;
    }, total);
  }

  chage(val: any) {
    console.log(val);
  }
}
